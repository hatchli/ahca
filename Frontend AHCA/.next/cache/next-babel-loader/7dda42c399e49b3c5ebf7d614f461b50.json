{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Wade\\\\Documents\\\\AHCA Web\\\\Frontend AHCA\\\\components\\\\Map.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport { Mutation } from \"react-apollo\";\nimport gql from \"graphql-tag\";\nimport MapGL, { LinearInterpolator, GeolocateControl } from \"react-map-gl\";\nimport WebMercatorViewport from \"viewport-mercator-project\";\nimport bbox from \"@turf/bbox\";\nimport ControlPanel from \"./ControlPanel\";\nimport MAP_STYLE from \"./styles/MapStyles\";\nimport { Box, Flex } from \"rebass\"; // import MAP_STYLE from 'https://api.mapbox.com/styles/v1/mapbox/light-v9.html?title=false&access_token=pk.eyJ1IjoibXNsZWUiLCJhIjoiclpiTWV5SSJ9.P_h8r37vD8jpIH1A6i1VRg#7.75/33.997/-116.72'\n\nimport LocationCard from \"./LocationCard\";\nconst TOKEN = \"pk.eyJ1Ijoid2xlZXMiLCJhIjoiY2s0YnBoZDQzMGZ6bjNudXFiMmkwbHRsMCJ9.vej5vu3WZhr9AEHiNPrVow\"; // Set your mapbox token here\n\nconst geolocateStyle = {\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  margin: 10\n};\nconst UPDATE_PHONE_LOCATION = gql`\n  mutation UPDATE_PHONE_LOCATION(\n    $name: String\n    $location: String\n    $phone: String\n    $email: String\n  ) {\n    updatePhoneLocation(\n      name: $name\n      location: $location\n      phone: $phone\n      email: $email\n    ) {\n      id\n    }\n  }\n`;\nexport default class Map extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"_updateViewport\", viewport => {\n      this.setState({\n        viewport\n      });\n    });\n\n    _defineProperty(this, \"_onClick\", event => {\n      let countyName = \"\";\n      let clickInfo = null;\n      let county = event.features[0];\n      let feature = event.features[0];\n\n      if (county) {\n        clickInfo = {\n          lngLat: event.lngLat,\n          county: county.properties\n        };\n        countyName = clickInfo.county.name;\n      }\n\n      if (feature) {\n        // calculate the bounding box of the feature\n        const [minLng, minLat, maxLng, maxLat] = bbox(feature); // construct a viewport instance from the current state\n\n        const viewport = new WebMercatorViewport(this.state.viewport);\n        const {\n          longitude,\n          latitude,\n          zoom\n        } = viewport.fitBounds([[minLng, minLat], [maxLng, maxLat]], {\n          padding: 0,\n          zoom: 7\n        });\n        console.log(zoom);\n        this.setState({\n          county: countyName,\n          clickInfo,\n          viewport: _objectSpread({}, this.state.viewport, {\n            longitude,\n            latitude,\n            zoom,\n            transitionInterpolator: new LinearInterpolator({\n              around: [event.offsetCenter.x, event.offsetCenter.y]\n            }),\n            transitionDuration: 1000\n          })\n        });\n      }\n    });\n\n    this.state = {\n      county: \"Select Your Location on the Map!\",\n      viewport: {\n        latitude: 34.0537,\n        longitude: -118.243,\n        zoom: 7,\n        bearing: 0,\n        pitch: 0\n      },\n      popupInfo: null,\n      clickInfo: null\n    };\n    this._map = React.createRef();\n  }\n\n  render() {\n    const {\n      viewport\n    } = this.state;\n    const {\n      clickInfo\n    } = this.state;\n    const {\n      county\n    } = this.state;\n    let minZoom = 7;\n    return __jsx(Mutation, {\n      mutation: UPDATE_PHONE_LOCATION,\n      variables: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, (updatePhoneLocation, {\n      loading,\n      error\n    }) => {\n      return __jsx(Flex, {\n        flexWrap: \"wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, __jsx(Box, {\n        width: [1, 1, 1 / 2],\n        minHeight: \"300px\",\n        minWidth: \"300px\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, __jsx(MapGL, _extends({\n        ref: this._map,\n        mapStyle: MAP_STYLE,\n        interactiveLayerIds: [\"sf-neighborhoods-fill\"]\n      }, viewport, {\n        width: \"100%\",\n        height: \"100%\",\n        minZoom: minZoom,\n        minHeight: \"1vh\",\n        minWidth: \"1vh\",\n        onClick: this._onClick,\n        county: county // countyInfo={}\n        ,\n        onViewportChange: this._updateViewport,\n        mapboxApiAccessToken: TOKEN,\n        onTransitionEnd: async () => {\n          console.log(\"onchange called\");\n          const res = await updatePhoneLocation();\n          console.log(res);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }), __jsx(ControlPanel, {\n        containerComponent: this.props.containerComponent,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }), __jsx(GeolocateControl, {\n        style: geolocateStyle,\n        positionOptions: {\n          enableHighAccuracy: true\n        },\n        trackUserLocation: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }))), __jsx(Box, {\n        px: 3,\n        width: [1, 1, 1 / 2],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, __jsx(LocationCard, {\n        county: county,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      })));\n    });\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Wade/Documents/AHCA Web/Frontend AHCA/components/Map.js"],"names":["React","Component","Mutation","gql","MapGL","LinearInterpolator","GeolocateControl","WebMercatorViewport","bbox","ControlPanel","MAP_STYLE","Box","Flex","LocationCard","TOKEN","geolocateStyle","position","top","left","margin","UPDATE_PHONE_LOCATION","Map","constructor","props","viewport","setState","event","countyName","clickInfo","county","features","feature","lngLat","properties","name","minLng","minLat","maxLng","maxLat","state","longitude","latitude","zoom","fitBounds","padding","console","log","transitionInterpolator","around","offsetCenter","x","y","transitionDuration","bearing","pitch","popupInfo","_map","createRef","render","minZoom","updatePhoneLocation","loading","error","_onClick","_updateViewport","res","containerComponent","enableHighAccuracy"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Mutation } from \"react-apollo\";\r\nimport gql from \"graphql-tag\";\r\nimport MapGL, { LinearInterpolator, GeolocateControl } from \"react-map-gl\";\r\nimport WebMercatorViewport from \"viewport-mercator-project\";\r\nimport bbox from \"@turf/bbox\";\r\n\r\nimport ControlPanel from \"./ControlPanel\";\r\nimport MAP_STYLE from \"./styles/MapStyles\";\r\nimport { Box, Flex } from \"rebass\";\r\n// import MAP_STYLE from 'https://api.mapbox.com/styles/v1/mapbox/light-v9.html?title=false&access_token=pk.eyJ1IjoibXNsZWUiLCJhIjoiclpiTWV5SSJ9.P_h8r37vD8jpIH1A6i1VRg#7.75/33.997/-116.72'\r\nimport LocationCard from \"./LocationCard\";\r\n\r\nconst TOKEN =\r\n  \"pk.eyJ1Ijoid2xlZXMiLCJhIjoiY2s0YnBoZDQzMGZ6bjNudXFiMmkwbHRsMCJ9.vej5vu3WZhr9AEHiNPrVow\"; // Set your mapbox token here\r\n\r\nconst geolocateStyle = {\r\n  position: \"absolute\",\r\n  top: 0,\r\n  left: 0,\r\n  margin: 10\r\n};\r\n\r\nconst UPDATE_PHONE_LOCATION = gql`\r\n  mutation UPDATE_PHONE_LOCATION(\r\n    $name: String\r\n    $location: String\r\n    $phone: String\r\n    $email: String\r\n  ) {\r\n    updatePhoneLocation(\r\n      name: $name\r\n      location: $location\r\n      phone: $phone\r\n      email: $email\r\n    ) {\r\n      id\r\n    }\r\n  }\r\n`;\r\n\r\nexport default class Map extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      county: \"Select Your Location on the Map!\",\r\n      viewport: {\r\n        latitude: 34.0537,\r\n        longitude: -118.243,\r\n        zoom: 7,\r\n        bearing: 0,\r\n        pitch: 0\r\n      },\r\n      popupInfo: null,\r\n      clickInfo: null\r\n    };\r\n\r\n    this._map = React.createRef();\r\n  }\r\n\r\n  _updateViewport = viewport => {\r\n    this.setState({ viewport });\r\n  };\r\n\r\n  _onClick = event => {\r\n    let countyName = \"\";\r\n    let clickInfo = null;\r\n    let county = event.features[0];\r\n    let feature = event.features[0];\r\n\r\n    if (county) {\r\n      clickInfo = {\r\n        lngLat: event.lngLat,\r\n        county: county.properties\r\n      };\r\n      countyName = clickInfo.county.name;\r\n    }\r\n    if (feature) {\r\n      // calculate the bounding box of the feature\r\n      const [minLng, minLat, maxLng, maxLat] = bbox(feature);\r\n      // construct a viewport instance from the current state\r\n      const viewport = new WebMercatorViewport(this.state.viewport);\r\n      const { longitude, latitude, zoom } = viewport.fitBounds(\r\n        [\r\n          [minLng, minLat],\r\n          [maxLng, maxLat]\r\n        ],\r\n        {\r\n          padding: 0,\r\n          zoom: 7\r\n        }\r\n      );\r\n      console.log(zoom);\r\n\r\n      this.setState({\r\n        county: countyName,\r\n        clickInfo,\r\n        viewport: {\r\n          ...this.state.viewport,\r\n          longitude,\r\n          latitude,\r\n          zoom,\r\n          transitionInterpolator: new LinearInterpolator({\r\n            around: [event.offsetCenter.x, event.offsetCenter.y]\r\n          }),\r\n          transitionDuration: 1000\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { viewport } = this.state;\r\n    const { clickInfo } = this.state;\r\n    const { county } = this.state;\r\n    let minZoom = 7;\r\n\r\n    return (\r\n      <Mutation mutation={UPDATE_PHONE_LOCATION} variables={this.state}>\r\n        {(updatePhoneLocation, { loading, error }) => {\r\n          return (\r\n            <Flex flexWrap=\"wrap\">\r\n              <Box width={[1, 1, 1 / 2]} minHeight=\"300px\" minWidth=\"300px\">\r\n                <MapGL\r\n                  ref={this._map}\r\n                  mapStyle={MAP_STYLE}\r\n                  interactiveLayerIds={[\"sf-neighborhoods-fill\"]}\r\n                  {...viewport}\r\n                  width=\"100%\"\r\n                  height=\"100%\"\r\n                  minZoom={minZoom}\r\n                  minHeight=\"1vh\"\r\n                  minWidth=\"1vh\"\r\n                  onClick={this._onClick}\r\n                  county={county}\r\n                  // countyInfo={}\r\n                  onViewportChange={this._updateViewport}\r\n                  mapboxApiAccessToken={TOKEN}\r\n                  onTransitionEnd={async () => {\r\n                    console.log(\"onchange called\");\r\n                    const res = await updatePhoneLocation();\r\n                    console.log(res);\r\n                  }}\r\n                >\r\n                  <ControlPanel\r\n                    containerComponent={this.props.containerComponent}\r\n                  />\r\n                  <GeolocateControl\r\n                    style={geolocateStyle}\r\n                    positionOptions={{ enableHighAccuracy: true }}\r\n                    trackUserLocation={true}\r\n                  />\r\n                </MapGL>\r\n              </Box>\r\n              <Box px={3} width={[1, 1, 1 / 2]}>\r\n                <LocationCard county={county} />\r\n              </Box>\r\n            </Flex>\r\n          );\r\n        }}\r\n      </Mutation>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}