{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nimport _parseFloat from \"@babel/runtime-corejs2/core-js/parse-float\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Wade\\\\Documents\\\\AHCA Web\\\\Frontend AHCA\\\\components\\\\CreateItem.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport { Box, Flex } from \"rebass\";\nimport { Mutation } from \"react-apollo\";\nimport gql from \"graphql-tag\";\nimport Router from \"next/router\";\nimport Form from \"./styles/Form\";\nimport Error from \"./ErrorMessage\";\nimport WidthStyles from \"./styles/WidthStyles\";\nconst possibleCategories = [\"AIRCONDITIONER\", \"FURNACE\", \"WHOLEHOMEMANIFOLD\", \"TANKLESSWATERSYSTEM\", \"WATERSOFTENER\", \"WATERFILTRATION\", \"PLUMBING\", \"HEATPUMP\", \"DUCTLESSMINISPLIT\"];\nconst promoCodes = [\"LACOUNTY2020\", \"SFCOUNTY2020\"];\nconst CREATE_ITEM_MUTATION = gql`\n  mutation CREATE_ITEM_MUTATION(\n    $title: String!\n    $description: String!\n    $features: [FeatureInput!]\n    $highlights: [HighlightInput!]\n    $sale: Boolean\n    $categories: [Category]\n    $price: Int!\n    $promo: [ValidPromoCodes]\n    $image: String\n    $largeImage: String\n    $image1: String\n    $largeImage1: String\n    $image2: String\n    $largeImage2: String\n  ) {\n    createItem(\n      title: $title\n      description: $description\n      features: $features\n      highlights: $highlights\n      sale: $sale\n      categories: $categories\n      price: $price\n      promo: $promo\n      image: $image\n      largeImage: $largeImage\n      image1: $image1\n      largeImage1: $largeImage1\n      image2: $image2\n      largeImage2: $largeImage2\n    ) {\n      id\n    }\n  }\n`;\n\nclass CreateItem extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      title: \"\",\n      description: \"\",\n      features: [\"\"],\n      highlights: [],\n      sale: false,\n      categories: \"\",\n      imageArray: [],\n      largeImageArray: [],\n      image: \"\",\n      largeImage: \"\",\n      image1: \"\",\n      largeImage1: \"\",\n      image2: \"\",\n      largeImage2: \"\",\n      price: 0,\n      promo: []\n    });\n\n    _defineProperty(this, \"handleChange\", e => {\n      console.log(\"value: \", e.target.value);\n      console.log(\"name: \", e.target.name);\n      const {\n        name,\n        type,\n        value\n      } = e.target;\n      const val = type === \"number\" ? _parseFloat(value) : value;\n      console.log(\"name: \", name, \"val: \", val);\n      this.setState({\n        [name]: val\n      });\n    });\n\n    _defineProperty(this, \"handleFeatureArrayChange\", e => {\n      const {\n        name,\n        type,\n        value\n      } = e.target;\n      this.setState(prevState => ({\n        features: prevState.features.map((feat, key) => {\n          if (key == name) {\n            return value;\n          } else return feat;\n        })\n      }));\n    });\n\n    _defineProperty(this, \"keyPress\", e => {\n      if (e.keyCode == 13) {\n        this.setState({\n          features: this.state.features.concat(\"\")\n        });\n      }\n    });\n\n    _defineProperty(this, \"handleArrayChange\", e => {\n      this.setState({\n        promo: _Array$from(e.target.selectedOptions, item => item.value)\n      });\n    });\n\n    _defineProperty(this, \"uploadFileHandler\", async e => {\n      console.log(\"... uploading\");\n      const files = e.target.files;\n      const data = new FormData();\n\n      _Array$from(files).map(async file => {\n        data.append(\"file\", file);\n        data.append(\"upload_preset\", \"americansavings\");\n        const res = await fetch(\"https://api.cloudinary.com/v1_1/americansavings/image/upload\", {\n          method: \"POST\",\n          body: data\n        });\n        const fileResp = await res.json();\n        console.log(\"fileResp\", fileResp);\n\n        if (!fileResp.error) {\n          this.setState(prevState => _objectSpread({}, prevState, {\n            imageArray: [...prevState.imageArray, fileResp.secure_url],\n            largeImageArray: [...prevState.largeImageArray, fileResp.eager[0].secure_url]\n          }));\n        } else {\n          this.setState(prevState => _objectSpread({}, prevState, {\n            imageArray: [...prevState.image],\n            largeImageArray: [...prevState.largeImage]\n          }));\n        }\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(\"prevState\", prevState.imageArray);\n    console.log(\"state of imageArray\", this.state.imageArray);\n\n    if (this.state.imageArray !== prevState.imageArray) {\n      this.setState(prevState => _objectSpread({}, prevState, {\n        image: this.state.imageArray[0],\n        largeImage: this.state.largeImageArray[0],\n        image1: this.state.imageArray[1],\n        largeImage1: this.state.largeImageArray[1],\n        image2: this.state.imageArray[2],\n        largeImage2: this.state.largeImageArray[2]\n      }));\n    }\n  }\n\n  render() {\n    return __jsx(WidthStyles, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, __jsx(Mutation, {\n      mutation: CREATE_ITEM_MUTATION,\n      variables: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, (createItem, {\n      loading,\n      error\n    }) => __jsx(Form, {\n      \"data-test\": \"form\",\n      onSubmit: async e => {\n        // Stop the form from submitting\n        e.preventDefault();\n        const res = await createItem(); // change them to the single item page\n\n        console.log(res);\n        Router.push({\n          pathname: \"/item\",\n          query: {\n            id: res.data.createItem.id\n          }\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, __jsx(Error, {\n      error: error,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }), __jsx(\"fieldset\", {\n      disabled: loading,\n      \"aria-busy\": loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, __jsx(Flex, {\n      px: 2,\n      justifyContent: \"space-between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      htmlFor: \"file\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Images\", __jsx(\"input\", {\n      multiple: true,\n      type: \"file\",\n      id: \"file\",\n      name: \"file\",\n      placeholder: \"Upload an image\",\n      required: true,\n      onChange: this.uploadFileHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }))), __jsx(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, \"Title\", __jsx(\"input\", {\n      type: \"text\",\n      id: \"title\",\n      name: \"title\",\n      placeholder: \"Title\",\n      required: true,\n      value: this.state.title,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    })), __jsx(\"label\", {\n      htmlFor: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, \"Price\", __jsx(\"input\", {\n      type: \"number\",\n      id: \"price\",\n      name: \"price\",\n      placeholder: \"Price\",\n      required: true,\n      value: this.state.price,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    })), __jsx(\"label\", {\n      htmlFor: \"sale\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, \"Sale\", __jsx(\"input\", {\n      type: \"checkbox\",\n      id: \"sale\",\n      name: \"sale\",\n      value: this.state.sale,\n      onChange: () => {\n        this.setState({\n          sale: !this.state.value\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    })), __jsx(\"label\", {\n      htmlFor: \"categories\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, \"Category\", __jsx(\"select\", {\n      value: this.state.categories,\n      name: \"categories\",\n      id: \"categories\",\n      onChange: this.handleChange,\n      multiple: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, possibleCategories.map(category => __jsx(\"option\", {\n      key: category,\n      value: category,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, category)))), __jsx(\"label\", {\n      htmlFor: \"categories\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, \"Promo\", __jsx(\"select\", {\n      value: this.state.promo,\n      name: \"promo\",\n      id: \"promo\" // type=\"array\"\n      ,\n      onChange: this.handleArrayChange,\n      multiple: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, promoCodes.map(promo => __jsx(\"option\", {\n      key: promo.id,\n      value: promo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, promo)))), __jsx(\"label\", {\n      htmlFor: \"description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, \"Description\", __jsx(\"textarea\", {\n      id: \"description\",\n      name: \"description\",\n      placeholder: \"Enter A Description\",\n      required: true,\n      value: this.state.description,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    })), __jsx(\"label\", {\n      htmlFor: \"features\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, \"Features\", this.state.features.map((feature, i) => __jsx(\"div\", {\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, __jsx(\"textarea\", {\n      key: i,\n      type: \"features\",\n      placeholder: `${feature}` // supply a unique \"name\" attribute using string interpolation\n      ,\n      name: i,\n      value: this.state.features[i],\n      onChange: this.handleFeatureArrayChange,\n      onKeyDown: this.keyPress,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    })))), __jsx(\"label\", {\n      htmlFor: \"highlights\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, \"Highlight\", __jsx(\"textarea\", {\n      id: \"highlight\",\n      name: \"highlight\",\n      placeholder: \"Enter A Highlight\",\n      required: true,\n      value: this.state.highlight,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    })), __jsx(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, \"Submit\")))));\n  }\n\n}\n\nexport default CreateItem;\nexport { CREATE_ITEM_MUTATION };","map":{"version":3,"sources":["C:/Users/Wade/Documents/AHCA Web/Frontend AHCA/components/CreateItem.js"],"names":["React","Component","Box","Flex","Mutation","gql","Router","Form","Error","WidthStyles","possibleCategories","promoCodes","CREATE_ITEM_MUTATION","CreateItem","title","description","features","highlights","sale","categories","imageArray","largeImageArray","image","largeImage","image1","largeImage1","image2","largeImage2","price","promo","e","console","log","target","value","name","type","val","setState","prevState","map","feat","key","keyCode","state","concat","selectedOptions","item","files","data","FormData","file","append","res","fetch","method","body","fileResp","json","error","secure_url","eager","componentDidUpdate","prevProps","render","createItem","loading","preventDefault","push","pathname","query","id","uploadFileHandler","handleChange","category","handleArrayChange","feature","i","handleFeatureArrayChange","keyPress","highlight"],"mappings":";;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,GAAT,EAAcC,IAAd,QAA0B,QAA1B;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,IAAP,MAAiB,eAAjB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AAEA,MAAMC,kBAAkB,GAAG,CACzB,gBADyB,EAEzB,SAFyB,EAGzB,mBAHyB,EAIzB,qBAJyB,EAKzB,eALyB,EAMzB,iBANyB,EAOzB,UAPyB,EAQzB,UARyB,EASzB,mBATyB,CAA3B;AAYA,MAAMC,UAAU,GAAG,CAAC,cAAD,EAAiB,cAAjB,CAAnB;AAEA,MAAMC,oBAAoB,GAAGP,GAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAjC;;AAsCA,MAAMQ,UAAN,SAAyBZ,SAAzB,CAAmC;AAAA;AAAA;;AAAA,mCACzB;AACNa,MAAAA,KAAK,EAAE,EADD;AAENC,MAAAA,WAAW,EAAE,EAFP;AAGNC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAHJ;AAINC,MAAAA,UAAU,EAAE,EAJN;AAKNC,MAAAA,IAAI,EAAE,KALA;AAMNC,MAAAA,UAAU,EAAE,EANN;AAONC,MAAAA,UAAU,EAAE,EAPN;AAQNC,MAAAA,eAAe,EAAE,EARX;AASNC,MAAAA,KAAK,EAAE,EATD;AAUNC,MAAAA,UAAU,EAAE,EAVN;AAWNC,MAAAA,MAAM,EAAE,EAXF;AAYNC,MAAAA,WAAW,EAAE,EAZP;AAaNC,MAAAA,MAAM,EAAE,EAbF;AAcNC,MAAAA,WAAW,EAAE,EAdP;AAeNC,MAAAA,KAAK,EAAE,CAfD;AAgBNC,MAAAA,KAAK,EAAE;AAhBD,KADyB;;AAAA,0CAoClBC,CAAC,IAAI;AAClBC,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBF,CAAC,CAACG,MAAF,CAASC,KAAhC;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBF,CAAC,CAACG,MAAF,CAASE,IAA/B;AACA,YAAM;AAAEA,QAAAA,IAAF;AAAQC,QAAAA,IAAR;AAAcF,QAAAA;AAAd,UAAwBJ,CAAC,CAACG,MAAhC;AACA,YAAMI,GAAG,GAAGD,IAAI,KAAK,QAAT,GAAoB,YAAWF,KAAX,CAApB,GAAwCA,KAApD;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBG,IAAtB,EAA4B,OAA5B,EAAqCE,GAArC;AACA,WAAKC,QAAL,CAAc;AAAE,SAACH,IAAD,GAAQE;AAAV,OAAd;AACD,KA3CgC;;AAAA,sDA6CNP,CAAC,IAAI;AAC9B,YAAM;AAAEK,QAAAA,IAAF;AAAQC,QAAAA,IAAR;AAAcF,QAAAA;AAAd,UAAwBJ,CAAC,CAACG,MAAhC;AACA,WAAKK,QAAL,CAAcC,SAAS,KAAK;AAC1BvB,QAAAA,QAAQ,EAAEuB,SAAS,CAACvB,QAAV,CAAmBwB,GAAnB,CAAuB,CAACC,IAAD,EAAOC,GAAP,KAAe;AAC9C,cAAIA,GAAG,IAAIP,IAAX,EAAiB;AACf,mBAAOD,KAAP;AACD,WAFD,MAEO,OAAOO,IAAP;AACR,SAJS;AADgB,OAAL,CAAvB;AAOD,KAtDgC;;AAAA,sCAwDtBX,CAAC,IAAI;AACd,UAAIA,CAAC,CAACa,OAAF,IAAa,EAAjB,EAAqB;AACnB,aAAKL,QAAL,CAAc;AACZtB,UAAAA,QAAQ,EAAE,KAAK4B,KAAL,CAAW5B,QAAX,CAAoB6B,MAApB,CAA2B,EAA3B;AADE,SAAd;AAGD;AACF,KA9DgC;;AAAA,+CAgEbf,CAAC,IAAI;AACvB,WAAKQ,QAAL,CAAc;AACZT,QAAAA,KAAK,EAAE,YAAWC,CAAC,CAACG,MAAF,CAASa,eAApB,EAAqCC,IAAI,IAAIA,IAAI,CAACb,KAAlD;AADK,OAAd;AAGD,KApEgC;;AAAA,+CA6Eb,MAAMJ,CAAN,IAAW;AAC7BC,MAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,YAAMgB,KAAK,GAAGlB,CAAC,CAACG,MAAF,CAASe,KAAvB;AAEA,YAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;;AACA,kBAAWF,KAAX,EAAkBR,GAAlB,CAAsB,MAAMW,IAAN,IAAc;AAClCF,QAAAA,IAAI,CAACG,MAAL,CAAY,MAAZ,EAAoBD,IAApB;AACAF,QAAAA,IAAI,CAACG,MAAL,CAAY,eAAZ,EAA6B,iBAA7B;AAEA,cAAMC,GAAG,GAAG,MAAMC,KAAK,CACrB,8DADqB,EAErB;AACEC,UAAAA,MAAM,EAAE,MADV;AAEEC,UAAAA,IAAI,EAAEP;AAFR,SAFqB,CAAvB;AAOA,cAAMQ,QAAQ,GAAG,MAAMJ,GAAG,CAACK,IAAJ,EAAvB;AACA3B,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwByB,QAAxB;;AAEA,YAAI,CAACA,QAAQ,CAACE,KAAd,EAAqB;AACnB,eAAKrB,QAAL,CAAcC,SAAS,sBAClBA,SADkB;AAErBnB,YAAAA,UAAU,EAAE,CAAC,GAAGmB,SAAS,CAACnB,UAAd,EAA0BqC,QAAQ,CAACG,UAAnC,CAFS;AAGrBvC,YAAAA,eAAe,EAAE,CACf,GAAGkB,SAAS,CAAClB,eADE,EAEfoC,QAAQ,CAACI,KAAT,CAAe,CAAf,EAAkBD,UAFH;AAHI,YAAvB;AAQD,SATD,MASO;AACL,eAAKtB,QAAL,CAAcC,SAAS,sBAClBA,SADkB;AAErBnB,YAAAA,UAAU,EAAE,CAAC,GAAGmB,SAAS,CAACjB,KAAd,CAFS;AAGrBD,YAAAA,eAAe,EAAE,CAAC,GAAGkB,SAAS,CAAChB,UAAd;AAHI,YAAvB;AAKD;AACF,OA9BD;AA+BD,KAjHgC;AAAA;;AAoBjCuC,EAAAA,kBAAkB,CAACC,SAAD,EAAYxB,SAAZ,EAAuB;AACvCR,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBO,SAAS,CAACnB,UAAnC;AACAW,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmC,KAAKY,KAAL,CAAWxB,UAA9C;;AACA,QAAI,KAAKwB,KAAL,CAAWxB,UAAX,KAA0BmB,SAAS,CAACnB,UAAxC,EAAoD;AAClD,WAAKkB,QAAL,CAAcC,SAAS,sBAClBA,SADkB;AAErBjB,QAAAA,KAAK,EAAE,KAAKsB,KAAL,CAAWxB,UAAX,CAAsB,CAAtB,CAFc;AAGrBG,QAAAA,UAAU,EAAE,KAAKqB,KAAL,CAAWvB,eAAX,CAA2B,CAA3B,CAHS;AAIrBG,QAAAA,MAAM,EAAE,KAAKoB,KAAL,CAAWxB,UAAX,CAAsB,CAAtB,CAJa;AAKrBK,QAAAA,WAAW,EAAE,KAAKmB,KAAL,CAAWvB,eAAX,CAA2B,CAA3B,CALQ;AAMrBK,QAAAA,MAAM,EAAE,KAAKkB,KAAL,CAAWxB,UAAX,CAAsB,CAAtB,CANa;AAOrBO,QAAAA,WAAW,EAAE,KAAKiB,KAAL,CAAWvB,eAAX,CAA2B,CAA3B;AAPQ,QAAvB;AASD;AACF;;AAiFD2C,EAAAA,MAAM,GAAG;AACP,WACE,MAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,QAAD;AAAU,MAAA,QAAQ,EAAEpD,oBAApB;AAA0C,MAAA,SAAS,EAAE,KAAKgC,KAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,CAACqB,UAAD,EAAa;AAAEC,MAAAA,OAAF;AAAWP,MAAAA;AAAX,KAAb,KACC,MAAC,IAAD;AACE,mBAAU,MADZ;AAEE,MAAA,QAAQ,EAAE,MAAM7B,CAAN,IAAW;AACnB;AACAA,QAAAA,CAAC,CAACqC,cAAF;AACA,cAAMd,GAAG,GAAG,MAAMY,UAAU,EAA5B,CAHmB,CAInB;;AACAlC,QAAAA,OAAO,CAACC,GAAR,CAAYqB,GAAZ;AACA/C,QAAAA,MAAM,CAAC8D,IAAP,CAAY;AACVC,UAAAA,QAAQ,EAAE,OADA;AAEVC,UAAAA,KAAK,EAAE;AAAEC,YAAAA,EAAE,EAAElB,GAAG,CAACJ,IAAJ,CAASgB,UAAT,CAAoBM;AAA1B;AAFG,SAAZ;AAID,OAZH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAcE,MAAC,KAAD;AAAO,MAAA,KAAK,EAAEZ,KAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAdF,EAeE;AAAU,MAAA,QAAQ,EAAEO,OAApB;AAA6B,mBAAWA,OAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAM,MAAA,EAAE,EAAE,CAAV;AAAa,MAAA,cAAc,EAAC,eAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAO,MAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAEE;AACE,MAAA,QAAQ,MADV;AAEE,MAAA,IAAI,EAAC,MAFP;AAGE,MAAA,EAAE,EAAC,MAHL;AAIE,MAAA,IAAI,EAAC,MAJP;AAKE,MAAA,WAAW,EAAC,iBALd;AAME,MAAA,QAAQ,MANV;AAOE,MAAA,QAAQ,EAAE,KAAKM,iBAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF,CADF,EAoBE;AAAO,MAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAEE;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,EAAE,EAAC,OAFL;AAGE,MAAA,IAAI,EAAC,OAHP;AAIE,MAAA,WAAW,EAAC,OAJd;AAKE,MAAA,QAAQ,MALV;AAME,MAAA,KAAK,EAAE,KAAK5B,KAAL,CAAW9B,KANpB;AAOE,MAAA,QAAQ,EAAE,KAAK2D,YAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CApBF,EAiCE;AAAO,MAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAEE;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,EAAE,EAAC,OAFL;AAGE,MAAA,IAAI,EAAC,OAHP;AAIE,MAAA,WAAW,EAAC,OAJd;AAKE,MAAA,QAAQ,MALV;AAME,MAAA,KAAK,EAAE,KAAK7B,KAAL,CAAWhB,KANpB;AAOE,MAAA,QAAQ,EAAE,KAAK6C,YAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAjCF,EA6CE;AAAO,MAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAEE;AACE,MAAA,IAAI,EAAC,UADP;AAEE,MAAA,EAAE,EAAC,MAFL;AAGE,MAAA,IAAI,EAAC,MAHP;AAIE,MAAA,KAAK,EAAE,KAAK7B,KAAL,CAAW1B,IAJpB;AAKE,MAAA,QAAQ,EAAE,MAAM;AACd,aAAKoB,QAAL,CAAc;AAAEpB,UAAAA,IAAI,EAAE,CAAC,KAAK0B,KAAL,CAAWV;AAApB,SAAd;AACD,OAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CA7CF,EAyDE;AAAO,MAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEE;AACE,MAAA,KAAK,EAAE,KAAKU,KAAL,CAAWzB,UADpB;AAEE,MAAA,IAAI,EAAC,YAFP;AAGE,MAAA,EAAE,EAAC,YAHL;AAIE,MAAA,QAAQ,EAAE,KAAKsD,YAJjB;AAKE,MAAA,QAAQ,EAAE,KALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOG/D,kBAAkB,CAAC8B,GAAnB,CAAuBkC,QAAQ,IAC9B;AAAQ,MAAA,GAAG,EAAEA,QAAb;AAAuB,MAAA,KAAK,EAAEA,QAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGA,QADH,CADD,CAPH,CAFF,CAzDF,EAyEE;AAAO,MAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAEE;AACE,MAAA,KAAK,EAAE,KAAK9B,KAAL,CAAWf,KADpB;AAEE,MAAA,IAAI,EAAC,OAFP;AAGE,MAAA,EAAE,EAAC,OAHL,CAIE;AAJF;AAKE,MAAA,QAAQ,EAAE,KAAK8C,iBALjB;AAME,MAAA,QAAQ,MANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQGhE,UAAU,CAAC6B,GAAX,CAAeX,KAAK,IACnB;AAAQ,MAAA,GAAG,EAAEA,KAAK,CAAC0C,EAAnB;AAAuB,MAAA,KAAK,EAAE1C,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGA,KADH,CADD,CARH,CAFF,CAzEF,EA2FE;AAAO,MAAA,OAAO,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEE;AACE,MAAA,EAAE,EAAC,aADL;AAEE,MAAA,IAAI,EAAC,aAFP;AAGE,MAAA,WAAW,EAAC,qBAHd;AAIE,MAAA,QAAQ,MAJV;AAKE,MAAA,KAAK,EAAE,KAAKe,KAAL,CAAW7B,WALpB;AAME,MAAA,QAAQ,EAAE,KAAK0D,YANjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CA3FF,EAsGE;AAAO,MAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEG,KAAK7B,KAAL,CAAW5B,QAAX,CAAoBwB,GAApB,CAAwB,CAACoC,OAAD,EAAUC,CAAV,KACvB;AAAK,MAAA,GAAG,EAAEA,CAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,GAAG,EAAEA,CADP;AAEE,MAAA,IAAI,EAAC,UAFP;AAGE,MAAA,WAAW,EAAG,GAAED,OAAQ,EAH1B,CAIE;AAJF;AAKE,MAAA,IAAI,EAAEC,CALR;AAME,MAAA,KAAK,EAAE,KAAKjC,KAAL,CAAW5B,QAAX,CAAoB6D,CAApB,CANT;AAOE,MAAA,QAAQ,EAAE,KAAKC,wBAPjB;AAQE,MAAA,SAAS,EAAE,KAAKC,QARlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADD,CAFH,CAtGF,EAuHE;AAAO,MAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEE;AACE,MAAA,EAAE,EAAC,WADL;AAEE,MAAA,IAAI,EAAC,WAFP;AAGE,MAAA,WAAW,EAAC,mBAHd;AAIE,MAAA,QAAQ,MAJV;AAKE,MAAA,KAAK,EAAE,KAAKnC,KAAL,CAAWoC,SALpB;AAME,MAAA,QAAQ,EAAE,KAAKP,YANjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAvHF,EAkIE;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlIF,CAfF,CAFJ,CADF,CADF;AA4JD;;AAhRgC;;AAmRnC,eAAe5D,UAAf;AACA,SAASD,oBAAT","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Box, Flex } from \"rebass\";\r\nimport { Mutation } from \"react-apollo\";\r\nimport gql from \"graphql-tag\";\r\nimport Router from \"next/router\";\r\nimport Form from \"./styles/Form\";\r\nimport Error from \"./ErrorMessage\";\r\nimport WidthStyles from \"./styles/WidthStyles\";\r\n\r\nconst possibleCategories = [\r\n  \"AIRCONDITIONER\",\r\n  \"FURNACE\",\r\n  \"WHOLEHOMEMANIFOLD\",\r\n  \"TANKLESSWATERSYSTEM\",\r\n  \"WATERSOFTENER\",\r\n  \"WATERFILTRATION\",\r\n  \"PLUMBING\",\r\n  \"HEATPUMP\",\r\n  \"DUCTLESSMINISPLIT\"\r\n];\r\n\r\nconst promoCodes = [\"LACOUNTY2020\", \"SFCOUNTY2020\"];\r\n\r\nconst CREATE_ITEM_MUTATION = gql`\r\n  mutation CREATE_ITEM_MUTATION(\r\n    $title: String!\r\n    $description: String!\r\n    $features: [FeatureInput!]\r\n    $highlights: [HighlightInput!]\r\n    $sale: Boolean\r\n    $categories: [Category]\r\n    $price: Int!\r\n    $promo: [ValidPromoCodes]\r\n    $image: String\r\n    $largeImage: String\r\n    $image1: String\r\n    $largeImage1: String\r\n    $image2: String\r\n    $largeImage2: String\r\n  ) {\r\n    createItem(\r\n      title: $title\r\n      description: $description\r\n      features: $features\r\n      highlights: $highlights\r\n      sale: $sale\r\n      categories: $categories\r\n      price: $price\r\n      promo: $promo\r\n      image: $image\r\n      largeImage: $largeImage\r\n      image1: $image1\r\n      largeImage1: $largeImage1\r\n      image2: $image2\r\n      largeImage2: $largeImage2\r\n    ) {\r\n      id\r\n    }\r\n  }\r\n`;\r\n\r\nclass CreateItem extends Component {\r\n  state = {\r\n    title: \"\",\r\n    description: \"\",\r\n    features: [\"\"],\r\n    highlights: [],\r\n    sale: false,\r\n    categories: \"\",\r\n    imageArray: [],\r\n    largeImageArray: [],\r\n    image: \"\",\r\n    largeImage: \"\",\r\n    image1: \"\",\r\n    largeImage1: \"\",\r\n    image2: \"\",\r\n    largeImage2: \"\",\r\n    price: 0,\r\n    promo: []\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    console.log(\"prevState\", prevState.imageArray);\r\n    console.log(\"state of imageArray\", this.state.imageArray);\r\n    if (this.state.imageArray !== prevState.imageArray) {\r\n      this.setState(prevState => ({\r\n        ...prevState,\r\n        image: this.state.imageArray[0],\r\n        largeImage: this.state.largeImageArray[0],\r\n        image1: this.state.imageArray[1],\r\n        largeImage1: this.state.largeImageArray[1],\r\n        image2: this.state.imageArray[2],\r\n        largeImage2: this.state.largeImageArray[2]\r\n      }));\r\n    }\r\n  }\r\n\r\n  handleChange = e => {\r\n    console.log(\"value: \", e.target.value);\r\n    console.log(\"name: \", e.target.name);\r\n    const { name, type, value } = e.target;\r\n    const val = type === \"number\" ? parseFloat(value) : value;\r\n    console.log(\"name: \", name, \"val: \", val);\r\n    this.setState({ [name]: val });\r\n  };\r\n\r\n  handleFeatureArrayChange = e => {\r\n    const { name, type, value } = e.target;\r\n    this.setState(prevState => ({\r\n      features: prevState.features.map((feat, key) => {\r\n        if (key == name) {\r\n          return value;\r\n        } else return feat;\r\n      })\r\n    }));\r\n  };\r\n\r\n  keyPress = e => {\r\n    if (e.keyCode == 13) {\r\n      this.setState({\r\n        features: this.state.features.concat(\"\")\r\n      });\r\n    }\r\n  };\r\n\r\n  handleArrayChange = e => {\r\n    this.setState({\r\n      promo: Array.from(e.target.selectedOptions, item => item.value)\r\n    });\r\n  };\r\n\r\n  // handleFeatureHighlightChange = e => {\r\n  //   const { name, type, value } = e.target;\r\n  //   this.setState(state => ({\r\n  //     features: Array.from(value.split(\"\\n\"))\r\n  //   }));\r\n  // };\r\n\r\n  uploadFileHandler = async e => {\r\n    console.log(\"... uploading\");\r\n    const files = e.target.files;\r\n\r\n    const data = new FormData();\r\n    Array.from(files).map(async file => {\r\n      data.append(\"file\", file);\r\n      data.append(\"upload_preset\", \"americansavings\");\r\n\r\n      const res = await fetch(\r\n        \"https://api.cloudinary.com/v1_1/americansavings/image/upload\",\r\n        {\r\n          method: \"POST\",\r\n          body: data\r\n        }\r\n      );\r\n      const fileResp = await res.json();\r\n      console.log(\"fileResp\", fileResp);\r\n\r\n      if (!fileResp.error) {\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          imageArray: [...prevState.imageArray, fileResp.secure_url],\r\n          largeImageArray: [\r\n            ...prevState.largeImageArray,\r\n            fileResp.eager[0].secure_url\r\n          ]\r\n        }));\r\n      } else {\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          imageArray: [...prevState.image],\r\n          largeImageArray: [...prevState.largeImage]\r\n        }));\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <WidthStyles>\r\n        <Mutation mutation={CREATE_ITEM_MUTATION} variables={this.state}>\r\n          {(createItem, { loading, error }) => (\r\n            <Form\r\n              data-test=\"form\"\r\n              onSubmit={async e => {\r\n                // Stop the form from submitting\r\n                e.preventDefault();\r\n                const res = await createItem();\r\n                // change them to the single item page\r\n                console.log(res);\r\n                Router.push({\r\n                  pathname: \"/item\",\r\n                  query: { id: res.data.createItem.id }\r\n                });\r\n              }}\r\n            >\r\n              <Error error={error} />\r\n              <fieldset disabled={loading} aria-busy={loading}>\r\n                <Flex px={2} justifyContent=\"space-between\">\r\n                  <label htmlFor=\"file\">\r\n                    Images\r\n                    <input\r\n                      multiple\r\n                      type=\"file\"\r\n                      id=\"file\"\r\n                      name=\"file\"\r\n                      placeholder=\"Upload an image\"\r\n                      required\r\n                      onChange={this.uploadFileHandler}\r\n                    />\r\n                    {/* {this.state.image &&\r\n                      this.state.image.map(image => (\r\n                        <img width=\"200\" src={image} alt=\"Upload Preview\" />\r\n                      ))} */}\r\n                  </label>\r\n                </Flex>\r\n\r\n                <label htmlFor=\"title\">\r\n                  Title\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"title\"\r\n                    name=\"title\"\r\n                    placeholder=\"Title\"\r\n                    required\r\n                    value={this.state.title}\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </label>\r\n\r\n                <label htmlFor=\"price\">\r\n                  Price\r\n                  <input\r\n                    type=\"number\"\r\n                    id=\"price\"\r\n                    name=\"price\"\r\n                    placeholder=\"Price\"\r\n                    required\r\n                    value={this.state.price}\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </label>\r\n                <label htmlFor=\"sale\">\r\n                  Sale\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"sale\"\r\n                    name=\"sale\"\r\n                    value={this.state.sale}\r\n                    onChange={() => {\r\n                      this.setState({ sale: !this.state.value });\r\n                    }}\r\n                  />\r\n                </label>\r\n                <label htmlFor=\"categories\">\r\n                  Category\r\n                  <select\r\n                    value={this.state.categories}\r\n                    name=\"categories\"\r\n                    id=\"categories\"\r\n                    onChange={this.handleChange}\r\n                    multiple={false}\r\n                  >\r\n                    {possibleCategories.map(category => (\r\n                      <option key={category} value={category}>\r\n                        {category}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </label>\r\n                <label htmlFor=\"categories\">\r\n                  Promo\r\n                  <select\r\n                    value={this.state.promo}\r\n                    name=\"promo\"\r\n                    id=\"promo\"\r\n                    // type=\"array\"\r\n                    onChange={this.handleArrayChange}\r\n                    multiple\r\n                  >\r\n                    {promoCodes.map(promo => (\r\n                      <option key={promo.id} value={promo}>\r\n                        {promo}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </label>\r\n\r\n                <label htmlFor=\"description\">\r\n                  Description\r\n                  <textarea\r\n                    id=\"description\"\r\n                    name=\"description\"\r\n                    placeholder=\"Enter A Description\"\r\n                    required\r\n                    value={this.state.description}\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </label>\r\n                <label htmlFor=\"features\">\r\n                  Features\r\n                  {this.state.features.map((feature, i) => (\r\n                    <div key={i}>\r\n                      <textarea\r\n                        key={i}\r\n                        type=\"features\"\r\n                        placeholder={`${feature}`}\r\n                        // supply a unique \"name\" attribute using string interpolation\r\n                        name={i}\r\n                        value={this.state.features[i]}\r\n                        onChange={this.handleFeatureArrayChange}\r\n                        onKeyDown={this.keyPress}\r\n                      />\r\n                    </div>\r\n                  ))}\r\n                </label>\r\n                <label htmlFor=\"highlights\">\r\n                  Highlight\r\n                  <textarea\r\n                    id=\"highlight\"\r\n                    name=\"highlight\"\r\n                    placeholder=\"Enter A Highlight\"\r\n                    required\r\n                    value={this.state.highlight}\r\n                    onChange={this.handleChange}\r\n                  />\r\n                </label>\r\n                <button type=\"submit\">Submit</button>\r\n              </fieldset>\r\n            </Form>\r\n          )}\r\n        </Mutation>\r\n      </WidthStyles>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CreateItem;\r\nexport { CREATE_ITEM_MUTATION };\r\n"]},"metadata":{},"sourceType":"module"}