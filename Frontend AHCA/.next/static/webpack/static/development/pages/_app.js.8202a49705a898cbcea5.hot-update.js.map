{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.8202a49705a898cbcea5.hot-update.js","sources":["webpack:///./components/Cart.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Query, Mutation } from \"react-apollo\";\r\nimport User from \"./User\";\r\nimport gql from \"graphql-tag\";\r\nimport CartStyles from \"./styles/CartStyles\";\r\nimport Supreme from \"./styles/Supreme\";\r\nimport CloseButton from \"./styles/CloseButton\";\r\nimport SickButton from \"./styles/SickButton\";\r\nimport CartItem from \"./CartItem\";\r\nimport calcTotalPrice from \"../lib/calcTotalPrice\";\r\nimport formatMoney from \"../lib/formatMoney\";\r\nimport { adopt } from \"react-adopt\";\r\nimport TakeMyMoney from \"./TakeMyMoney\";\r\nimport SignUpButton from \"./SignUpButton\";\r\n\r\nconst UPDATE_PHONE_ADDRESS = gql`\r\n  mutation UPDATE_PHONE_ADDRESS(\r\n    $name: String\r\n    $address: String\r\n    $postal: String\r\n    $phone: String\r\n    $email: String\r\n  ) {\r\n    updatePhoneLocation(\r\n      name: $name\r\n      address: $address\r\n      postal: $postal\r\n      phone: $phone\r\n      email: $email\r\n    ) {\r\n      id\r\n    }\r\n  }\r\n`;\r\n\r\nconst LOCAL_STATE_QUERY = gql`\r\n  query {\r\n    cartOpen @client\r\n  }\r\n`;\r\n\r\nconst TOGGLE_CART_MUTATION = gql`\r\n  mutation {\r\n    toggleCart @client\r\n  }\r\n`;\r\n\r\nconst Composed = adopt({\r\n  user: ({ render }) => <User>{render}</User>,\r\n  // cartItem: ({ render }) => <CartItem>{render}</CartItem>,\r\n  toggleCart: ({ render }) => (\r\n    <Mutation mutation={TOGGLE_CART_MUTATION}>{render}</Mutation>\r\n  ),\r\n  localState: ({ render }) => <Query query={LOCAL_STATE_QUERY}>{render}</Query>\r\n});\r\n\r\nconst Cart = (props, { item }) => {\r\n  const [nameState, setNameState] = useState(\"\");\r\n  const [addressState, setAddressState] = useState(\"\");\r\n  const [postalState, setPostalState] = useState(\"\");\r\n  const [phoneState, setPhoneState] = useState(\"\");\r\n  const [emailState, setEmailState] = useState(\"\");\r\n  return (\r\n    <Composed>\r\n      {({ user, toggleCart, localState }) => {\r\n        <Mutation\r\n          mutation={UPDATE_PHONE_ADDRESS}\r\n          variables={\r\n            (nameState, addressState, postalState, phoneState, emailState)\r\n          }\r\n        >\r\n          {(createGuest, { loading, error }) => {\r\n            console.log(\"user.data\", user.data);\r\n            {\r\n              /* console.log(\"cartItemwithinCart\", cartItem); */\r\n            }\r\n            const me = user.data ? user.data.me : null;\r\n            if (!me) return null;\r\n            setNameState(me?.name);\r\n            setAddressState(me?.address);\r\n            setPostalState(me?.postal);\r\n            setPhoneState(me?.phone);\r\n            setEmailState(me?.email);\r\n            return (\r\n              <CartStyles open={localState.data.cartOpen}>\r\n                <header>\r\n                  <CloseButton onClick={toggleCart} title=\"close\">\r\n                    &times;\r\n                  </CloseButton>\r\n                  {me.permissions.includes(\"GUEST\") ? (\r\n                    <Supreme>Guest Cart</Supreme>\r\n                  ) : (\r\n                    <Supreme>{me.name}'s Cart</Supreme>\r\n                  )}\r\n                  <p>\r\n                    You have {me.cart.length} item\r\n                    {me.cart.length === 1 ? \"\" : \"s\"} in your cart\r\n                  </p>\r\n                </header>\r\n                <ul>\r\n                  {me.cart.map(cartItem => (\r\n                    <>\r\n                      <CartItem key={cartItem.id} cartItem={cartItem} />\r\n                    </>\r\n                  ))}\r\n                </ul>\r\n                <footer>\r\n                  <p>{formatMoney(calcTotalPrice(me.cart))}</p>\r\n\r\n                  {me.cart.length ? (\r\n                    <TakeMyMoney>\r\n                      <SickButton disabled={false}>Checkout</SickButton>\r\n                    </TakeMyMoney>\r\n                  ) : me.permissions.includes(\"GUEST\") ? (\r\n                    <SickButton>\r\n                      <SignUpButton>Register</SignUpButton>\r\n                    </SickButton>\r\n                  ) : (\r\n                    <TakeMyMoney>\r\n                      <SickButton disabled={true}>Checkout</SickButton>\r\n                    </TakeMyMoney>\r\n                  )}\r\n                </footer>\r\n              </CartStyles>\r\n            );\r\n          }}\r\n        </Mutation>;\r\n      }}\r\n    </Composed>\r\n  );\r\n};\r\n\r\nexport default Cart;\r\nexport { LOCAL_STATE_QUERY, TOGGLE_CART_MUTATION };\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAoBA;AAMA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AACA;AAQA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAEA;AAGA;AACA;AACA;;;;;A","sourceRoot":""}